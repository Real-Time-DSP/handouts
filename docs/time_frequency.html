
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Time-Frequency Analysis &#8212; Dan Jacobellis | University of Texas at Austin | EE 445S Real-time DSP Lab | Spring 2022</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/theme.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-bootstrap.5fd3999ee7762ccc51105388f4a9d115.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="LTI filters and frequency selectivity" href="LTI_systems_filters.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <style>
@media print {
    .pagebreak { page-break-before: always; } /* page-break-after works, as well */
}
</style>
<p><strong>This is a draft. Please let me know if you see any errors.</strong></p>
<div class="tex2jax_ignore mathjax_ignore section" id="time-frequency-analysis">
<h1>Time-Frequency Analysis<a class="headerlink" href="#time-frequency-analysis" title="Permalink to this headline">¶</a></h1>
<p>An example of a joint time-frequency signal representation is standard musical notation.</p>
<p><img alt="" src="_images/music.png" /></p>
<p>Imagine that instead of this notation, we used a purely time-domain description that describes the shape of the acoustic waveform.</p>
<p><img alt="" src="_images/time.svg" /></p>
<p>Although the musician might be able to make out the rhythm and intensity clearly, it would be impossible to determine exactly which notes to play.</p>
<p>Now imagine that we used a purely frequency domain description, e.g. the Fourier transform.</p>
<p><img alt="" src="_images/freq.svg" /></p>
<p>This would show which notes to play, but it would be impossible to know when to play them.</p>
<p>In many applications (especially audio) the joint representation can reveal the most important aspects of a signal which might be hidden in the time or frequency domains alone.</p>
<p>Consider two more examples:</p>
<ol class="simple">
<li><p>The sound of a bird chirping</p></li>
<li><p>The ping from marine sonar system</p></li>
</ol>
<p><video width="740" height="400" style="float: right;" controls src="_static/chirp.mp4" />”</p>
<p><img alt="" src="_images/chirp.svg" /></p>
<p><video width="740" height="400" style="float: right;" controls src="_static/ping.mp4" />”</p>
<p><img alt="" src="_images/ping.svg" /></p>
<p>Although all three representations (time-domain, frequency-domain, and joint time-frequency) contain equivalent information, it is clear that the joint representation has several advantages.</p>
<p>Before we can dig deeper, we must take a step back and understand how time-frequency distributions like the ones above are constructed.</p>
<div class="section" id="the-short-time-fourier-transform-stft">
<h2>The short-time Fourier transform (STFT)<a class="headerlink" href="#the-short-time-fourier-transform-stft" title="Permalink to this headline">¶</a></h2>
<p>A common method for constructing a time-frequency distribution is the magnitude spectrogram, which is in-turn computed using a variation of the short-time Fourier transform (STFT)</p>
<div class="section" id="continuous-stft">
<h3>Continuous STFT<a class="headerlink" href="#continuous-stft" title="Permalink to this headline">¶</a></h3>
<p>The continuous-time STFT of a one-dimensional signal <span class="math notranslate nohighlight">\(x(t)\)</span> is a two-dimensional (time and frequency) representation <span class="math notranslate nohighlight">\(X(t,f)\)</span>.</p>
<p>Recall the definition of the conventional Fourier transform:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr F \{ x(t) \} &amp;\equiv X(f) \\
&amp;= \int_{t=-\infty}^{\infty}{ x(t) e^{-j 2\pi f t}dt}
\end{align}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(x(t)\)</span> is a function of time but <span class="math notranslate nohighlight">\(X(f)\)</span> is not because we’ve integrated over all time from <span class="math notranslate nohighlight">\(-\infty\)</span> to <span class="math notranslate nohighlight">\(\infty\)</span>.</p>
<p>In contrast, the STFT uses a window function <span class="math notranslate nohighlight">\(w(\tau)\)</span> to keep the time variable <span class="math notranslate nohighlight">\(t\)</span> while also introducing the frequency variable <span class="math notranslate nohighlight">\(f\)</span>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{STFT} \{x(t) \} &amp;\equiv X(t, f)\\
&amp;= \mathscr F \{ x(\tau) w(\tau-t) \}\\
&amp;= \int_{\tau=-\infty}^{\infty}{ x(\tau)w(\tau-t) e^{- j 2\pi f \tau}d\tau}
\end{align}\end{split}\]</div>
<div class="admonition-window-functions admonition">
<p class="admonition-title">Window functions</p>
<p>A window function <span class="math notranslate nohighlight">\(w(t)\)</span> is any function designed to ‘focus’ on a segment of a signal by suppressing everything outside of the window. Usually, <span class="math notranslate nohighlight">\(w(t)\)</span> is symmetric about the origin. If we want to focus on a signal <span class="math notranslate nohighlight">\(x(t)\)</span> near the origin then we use the product <span class="math notranslate nohighlight">\(x(t)w(t)\)</span>. To focus on <span class="math notranslate nohighlight">\(x(t)\)</span> at some location <span class="math notranslate nohighlight">\(a\)</span> instead of the origin, we shift the window function first, i.e. we use the product <span class="math notranslate nohighlight">\(x(t)w(t-a)\)</span>. We usually choose the amplitude <span class="math notranslate nohighlight">\(A\)</span> of a window so that it has unit energy, i.e. <span class="math notranslate nohighlight">\(\int{w^2 (t) dt} = 1\)</span>. The width of the window <span class="math notranslate nohighlight">\(\sigma\)</span> is an important parameter since it controls the trade-off between time and frequency resolution. Some common window functions are shown below.</p>
</div>
<div class="sphinx-bs container-lg pb-4 docutils">
<div class="row docutils">
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header text-center docutils">
<p class="card-text"><strong>Rectangular window</strong></p>
</div>
<div class="card-body docutils">
<div class="math notranslate nohighlight">
\[w(t)= A \text{ rect} \left(t/2 \sigma \right)\]</div>
<p class="card-text"><img alt="" src="_images/window_rect.svg" /></p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header text-center docutils">
<p class="card-text"><strong>Gaussian window</strong></p>
</div>
<div class="card-body docutils">
<div class="math notranslate nohighlight">
\[w(t) = A e^{-t^2/2\sigma^2} \]</div>
<p class="card-text"><img alt="" src="_images/window_gaussian.svg" /></p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header text-center docutils">
<p class="card-text"><strong>Lanczos window</strong></p>
</div>
<div class="card-body docutils">
<div class="math notranslate nohighlight">
\[ w(t) = A \text{ sinc} \left( \frac t \sigma \right) \text{rect} \left(\frac{t}{2\sigma} \right)\]</div>
<p class="card-text"><img alt="" src="_images/window_lanczos.svg" /></p>
</div>
</div>
</div>
<div class="d-flex col-lg-6 col-md-6 col-sm-6 col-xs-12 p-2 docutils">
<div class="card w-100 shadow docutils">
<div class="card-header text-center docutils">
<p class="card-text"><strong>Hann window</strong></p>
</div>
<div class="card-body docutils">
<div class="math notranslate nohighlight">
\[w(t) = \frac{A}{2}\left[1+\cos\left(\frac{\pi t}{\sigma}\right) \right]\text{rect} \left(\frac{t}{2\sigma} \right)\]</div>
<p class="card-text"><img alt="" src="_images/window_hann.svg" /></p>
</div>
</div>
</div>
</div>
</div>
<div class="admonition-equivalence-of-fourier-transform-and-fourier-series-for-windowed-signals admonition">
<p class="admonition-title">Equivalence of Fourier transform and Fourier series for windowed signals</p>
<p>Note that if the window function we choose has a finite width of <span class="math notranslate nohighlight">\(L\)</span>, then the integral bounds in the STFT can be equivalently written as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{STFT} \{x(t) \} &amp;= \mathscr F \{ x(\tau) w_L(\tau-t) \} \\
&amp;= \int_{\tau=-L/2}^{L/2}{ x(\tau)w_L(\tau-t) e^{-j 2\pi f \tau}d\tau}
\end{align}\end{split}\]</div>
<p>At each time <span class="math notranslate nohighlight">\(t\)</span>, this is equivalent to finding the <em>Fourier series</em> coefficients of the signal created by taking the <em>length <span class="math notranslate nohighlight">\(L\)</span> periodic extension</em> of <span class="math notranslate nohighlight">\(x(\tau)w_L(\tau-t)\)</span>.</p>
<p>In other words, once the window is applied, the Fourier transform is equivalent to a Fourier series.</p>
<p>The same is true in discrete time. If we first apply a finite length window <span class="math notranslate nohighlight">\(w_L[n]\)</span>, then the discrete-time Fourier transform (DTFT) is equivalent to the discrete Fourier transform (DFT).</p>
</div>
</div>
<div class="section" id="time-resolution-and-frequency-resolution">
<h3>Time resolution and frequency resolution<a class="headerlink" href="#time-resolution-and-frequency-resolution" title="Permalink to this headline">¶</a></h3>
<p>When analyzing a signal, there is a fundamental trade off between <strong>time resolution</strong> and <strong>frequency resolution</strong>.</p>
<p><img alt="" src="_images/time_freq_compare.svg" /></p>
<p>To understand this trade-off, consider a special case of the STFT where the window function is Gaussian $<span class="math notranslate nohighlight">\(w(t) = g_\sigma(t) = A e^{-t^2/2\sigma^2} \)</span>$. This is also known as the <strong>Gabor transform</strong>.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr G_\sigma \{x(t)\} &amp;= \text{STFT}_{\text{Gaussian window}} \{x(t)\} \\
&amp;= \mathscr F \{ x(\tau) w(\tau-t) \} \\
&amp;= \mathscr F \{ x(\tau) g_\sigma(\tau-t) \} \\
&amp;= \mathscr F \{ x(\tau) \} * \mathscr F \{ g_\sigma(\tau-t) \} \\
\end{align}\end{split}\]</div>
</div>
<div class="section" id="discrete-stft">
<h3>Discrete STFT<a class="headerlink" href="#discrete-stft" title="Permalink to this headline">¶</a></h3>
<p>The discrete version of the STFT replaces the Fourier transform with the discrete-time Fourier transform (DTFT). However, the discrete window function <span class="math notranslate nohighlight">\(w_L[n]\)</span> is typically causal (instead of centered on the origin) and has finite length <span class="math notranslate nohighlight">\(L\)</span>. As a result of the finite length, the DTFT is equivalent to a discrete Fourier transform (DFT), and the discrete STFT <span class="math notranslate nohighlight">\(X[n,k]\)</span> is sampled both time (indexed by <span class="math notranslate nohighlight">\(n\)</span>) and in frequency (indexed by <span class="math notranslate nohighlight">\(k\)</span>).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{STFT} \{x[n] \} &amp;\equiv X[n,k]\\
&amp;= \text{DTFT} \{ x[m]w_L[m-n] \}\\
&amp;= \sum_{m=-\infty}^{\infty}{ x[m] w_L[m-n] e^{-j 2 \pi f m}} \\
&amp;= \sum_{m=0}^{L-1}{ x[m] w_L[m-n] e^{-j 2 \pi k m / L}} \\
&amp;= \text{DFT} \{ x[m]w_L[m-n] \}
\end{align}\end{split}\]</div>
<div class="admonition-sampling-and-the-dtft admonition">
<p class="admonition-title">Sampling and the DTFT</p>
<p>The impulse train with sampling period <span class="math notranslate nohighlight">\(T_s\)</span> is defined as</p>
<div class="math notranslate nohighlight">
\[Ш_{T_s}(t)=\sum_{k=-\infty}^{\infty}{\delta(t-kT_s})\]</div>
<p>The fourier transform of an impulse train is another impulse train.</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\mathscr F \{ Ш_{T_s}(t) \} &amp;= \frac {1}{T_s} Ш_{1/T_s}(f) \\
&amp;=  f_s Ш_{f_s}(f)
\end{align}\end{split}\]</div>
<p>The operation of sampling can be modeled as multiplication with an impulse train.</p>
<div class="math notranslate nohighlight">
\[x[n] = x(t) \cdot Ш_{T_s}(t)\]</div>
<p>The fourier transform of a sampled signal is called the discrete-time Fourier transform (DTFT).</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\text{DTFT}_ \{x[n] \} &amp;= \sum_{n=-\infty}^{\infty}{x[n] e^{-j 2\pi f n}} \\
&amp;= \mathscr F \{ x(t) Ш_{T_s}(t) \} \\
&amp;= \frac{1}{2\pi} \mathscr F \{ x(t) \} * \mathscr F \{ Ш_{T_s}(t) \} \\
&amp;= \frac{f_s}{2\pi} X(f) * Ш_{f_s}(f) 
\end{align}\end{split}\]</div>
</div>
<p>In other words, to construct the discrete STFT, we perform 3 steps:</p>
<ol class="simple">
<li><p>Divide the signal <span class="math notranslate nohighlight">\(x[n]\)</span> into segments of length <span class="math notranslate nohighlight">\(L\)</span></p></li>
<li><p>Multiply each segment by the window function <span class="math notranslate nohighlight">\(w_L[n]\)</span></p></li>
<li><p>Compute the discrete Fourier transform of each windowed segment using the fast Fourier transform (FFT) algorithm.</p></li>
</ol>
<p>Since the Fourier transform is, in general, complex-valued, we rarely use the STFT directly. Instead, it is common to separate it into it’s magnitude and phase. The plot constructed from the magnitude of the STFT, like the ones shown earlier, is called the <strong>magnitude spectrogram</strong>.</p>
</div>
</div>
<div class="section" id="filter-banks">
<h2>Filter banks<a class="headerlink" href="#filter-banks" title="Permalink to this headline">¶</a></h2>
<p>Although the STFT has become ubiquitous for analyzing audio, another method of of time-frequency analysis existed long before computers and fast Fourier transform algorithms: the <strong>filter bank</strong>.</p>
<p><img alt="" src="_images/helmholtz.svg" /></p>
<p>An example of an analog filter bank used for time-frequency analysis, called the <em>Koenig flame apparatus</em>, is shown above. It utilizes an array of acoustic bandpass filters, called <em>Helmholtz resonators</em>, to visualize the frequency content of incoming sound using a rotating mirror to display the flame manometers which are connected to the array of Helmholtz resonators.</p>
<p>Even in the realm of digital implementation, the filter bank approach to time-frequency analysis has some advantages. When we use the DFT for frequency analysis, we are limited to equally spaced frequency bins and an average latency of <span class="math notranslate nohighlight">\(L/2\)</span> samples. However, we can design the array of bandpass filters in a filter bank to have whatever spacing, frequency response, or delay characteristics necessary for our application.</p>
<p>If we wanted to produce a similar number of frequency bands as we would typically get from the DFT (anywhere from tens to thousands of bands), then we would need to apply tens or thousands of discrete-time filters in parallel. This gets expensive very quickly! Fortunately, there is a more efficient method.</p>
<div class="section" id="multirate-filter-banks">
<h3>Multirate filter banks<a class="headerlink" href="#multirate-filter-banks" title="Permalink to this headline">¶</a></h3>
<p>To demonstrate the theory underlying multirate filter banks, let us consider one of the simplest examples: the <strong>Haar decomposition.</strong></p>
<div class="section" id="haar-decomposition">
<h4>Haar Decomposition<a class="headerlink" href="#haar-decomposition" title="Permalink to this headline">¶</a></h4>
<p>In 1909, mathematician Alfréd Haar used a procedure which we would now call a <em>discrete wavelet transform</em> using sums of differences of a list of numbers.</p>
<p>Consider the finite length signal <span class="math notranslate nohighlight">\(x[n]\)</span> below consisting of eight samples:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[0]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[1]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[2]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[3]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[4]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[5]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[6]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(x[7]\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>1</p></td>
<td class="text-align:center"><p>−13</p></td>
<td class="text-align:center"><p>20</p></td>
<td class="text-align:center"><p>4</p></td>
<td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>−18</p></td>
<td class="text-align:center"><p>5</p></td>
</tr>
</tbody>
</table>
<p>The transformation we will apply consists of creating two other signals <span class="math notranslate nohighlight">\(s[k]\)</span> and <span class="math notranslate nohighlight">\(d[k]\)</span> by taking sums and differences of adjacent samples from <span class="math notranslate nohighlight">\(x[n]\)</span>. However, the signals <span class="math notranslate nohighlight">\(s[k]\)</span> and <span class="math notranslate nohighlight">\(d[k]\)</span> will both half the length of the original signal <span class="math notranslate nohighlight">\(x[n]\)</span>.</p>
<div class="math notranslate nohighlight">
\[s[k] = x[2k] + x[2k+1]\]</div>
<div class="math notranslate nohighlight">
\[d[k] = x[2k+1] - x[2k]\]</div>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="text-align:center head"><p><span class="math notranslate nohighlight">\(d[0]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(d[0]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(s[1]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(d[1]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(s[2]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(d[2]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(s[3]\)</span></p></th>
<th class="text-align:center head"><p><span class="math notranslate nohighlight">\(d[3]\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="text-align:center"><p>7+1</p></td>
<td class="text-align:center"><p>1−7</p></td>
<td class="text-align:center"><p>−13+20</p></td>
<td class="text-align:center"><p>20+13</p></td>
<td class="text-align:center"><p>4+7</p></td>
<td class="text-align:center"><p>7−4</p></td>
<td class="text-align:center"><p>−18+5</p></td>
<td class="text-align:center"><p>5+18</p></td>
</tr>
<tr class="row-odd"><td class="text-align:center"><p>8</p></td>
<td class="text-align:center"><p>−6</p></td>
<td class="text-align:center"><p>7</p></td>
<td class="text-align:center"><p>33</p></td>
<td class="text-align:center"><p>11</p></td>
<td class="text-align:center"><p>3</p></td>
<td class="text-align:center"><p>−13</p></td>
<td class="text-align:center"><p>23</p></td>
</tr>
</tbody>
</table>
<p>Although these equations look similar to an LTI system specified by a difference equation, these relationships do not constitute LTI systems because they include <strong>downsampling operations</strong></p>
<div class="admonition-upsampling-and-downsampling admonition">
<p class="admonition-title">Upsampling and downsampling</p>
<p>The operations of upsampling and downsampling can be thought of as the discrete-time versions of <em>expansion</em> and <em>compression</em>.</p>
<p>Consider a continuous-time signal <span class="math notranslate nohighlight">\(x(t)=\sin{(\pi t^2)} \mathbf{1}_{[0,2]}(t)\)</span>.</p>
<p><span class="math notranslate nohighlight">\(x(t/2)\)</span> is the <em>expansion</em> of the signal by a factor of two.</p>
<p><span class="math notranslate nohighlight">\(x(2t)\)</span> is the <em>compression</em> of the signal by a factor of two.</p>
<p>Sampling <span class="math notranslate nohighlight">\(x(t)\)</span> at a rate <span class="math notranslate nohighlight">\(f_s=10 \text{Hz}\)</span> produces <span class="math notranslate nohighlight">\(x[n] = \sin{\left(\frac{\pi}{100} n^2\right)}\mathbf{1}_{[0,2]}(n)\)</span></p>
<p><span class="math notranslate nohighlight">\(x[n/2]\)</span> is the signal <em>upsampled</em> by a factor of two.</p>
<p><span class="math notranslate nohighlight">\(x[2n]\)</span> is the signal <em>downsampled</em> by a factor of two.</p>
<p><img alt="" src="_images/upsample_downsample.svg" /></p>
<p>A common convention is to use <span class="math notranslate nohighlight">\(\uparrow\)</span> to represent upsampling and <span class="math notranslate nohighlight">\(\downarrow\)</span> to represent downsampling. For example:</p>
<div class="math notranslate nohighlight">
\[\uparrow_2\{x[n]\} = x[n] \text{ upsampled by a factor of two} = x[n/2]\]</div>
<div class="math notranslate nohighlight">
\[\downarrow_2\{x[n]\} = x[n] \text{ downsampled by a factor of two} = x[2n]\]</div>
</div>
<p>We can equivalently express these two systems in terms of convolution (i.e. application of an LTI filter) and a downsampling operation.</p>
<div class="math notranslate nohighlight">
\[s[k] = \downarrow_2 \left\{x[n]*\left(\delta[k] + \delta[k-1]\right)\right\}\]</div>
<div class="math notranslate nohighlight">
\[d[k] = \downarrow_2 \left\{x[n]*\left(\delta[k] - \delta[k-1]\right)\right\}\]</div>
<p>This transformation, the Haar decomposition, can be considered a two-channel filter bank that decomposes the signal into a high-pass and a low-pass component, followed by downsampling by two.</p>
<div class="admonition-frequency-response-of-two-sample-sum-and-difference admonition">
<p class="admonition-title">Frequency response of two-sample sum and difference</p>
<p>The sum of two adjacent samples <a class="reference external" href="LTI_systems_filters.html#lowpass">is a low-pass filter with frequency response <span class="math notranslate nohighlight">\(H_s(\omega)=1+e^{-j\omega}\)</span></a></p>
<p>The difference <a class="reference external" href="LTI_systems_filters.html#highpass">is a highpass filter with frequency response <span class="math notranslate nohighlight">\(H_d(\omega)=1-e^{-j\omega}\)</span></a>.</p>
<p>It should come as no suprise then that by adding the outputs of these two filters, the result is an all-pass filter:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
H_{s+d}(\omega) &amp;=H_{s}(\omega) + H_{d}(\omega) \\
&amp;= \left( 1+e^{-j\omega} \right) + \left( 1-e^{-j\omega} \right)\\
&amp;= 2
\end{align}\end{split}\]</div>
</div>
<p>By recursive application of this process, we can divide the signal into arbitrarily many bands while maintaining a simple process to recover the signal. In particular, the <span class="math notranslate nohighlight">\(n\)</span>th sample of the original signal can be recovered using the following procedure:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align}
\hat x [n] &amp;= \uparrow_2 \{s[k]\} * \left( \frac 1 2 \delta[n-1] - \frac 1 2 \delta[n] \right) \\
&amp;+ \uparrow_2  \{ d[k] \} * \left(\frac 1 2 \delta[n-1] + \frac 1 2 \delta[n] \right)
\end{align}\end{split}\]</div>
</div>
</div>
</div>
</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">Handouts</a></h1>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="LTI_systems_filters.html">LTI filters and frequency selectivity</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Time-Frequency Analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#the-short-time-fourier-transform-stft">The short-time Fourier transform (STFT)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#filter-banks">Filter banks</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="LTI_systems_filters.html" title="previous chapter">LTI filters and frequency selectivity</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 4.3.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/time_frequency.md.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>